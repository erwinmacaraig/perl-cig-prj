<div class="document-upload">
	<!-- display document upload information --> 

<h3 class="panel-header">Required Documents</h3> 

<div class="panel-body">
	<div class="document-notes">
		<table class="table documents-table">
			[% index = 0 %]
			[% FOREACH doc IN documents %]
			[% index = index + 1 %]
				<tr>
					<td>
						<div>
							<p><strong>Title:</strong> 
							[% doc.Name %]
							</p>
							
							[% IF doc.Description != '' %]
							
							<p><strong>Description: </strong>
								[% doc.Description %]
							</p>
						
							[% END %]

							[% IF doc.strOrigFilename != '' %]
							
							<p>
								<a href="#" onclick="docViewer([% doc.intFileID %], 'client=[% client %]&amp;a=view'); return false;">[% doc.strOrigFilename %]</a>
							</p>
						
							[% END %]
						</div>
					</td>
					<td style="width:50%;">
						<form action="uploadregofile.cgi" method="POST" class="dropzone" enctype="multipart/form-data" id="myRegoDoc[% doc.ID %]">
							<input type="hidden" name="client" value="[% client %]" />
							<input type="hidden" name="rID" value="[% regoID %]" />
							<input type="hidden" name="doctypeID" value="[% doc.ID %]" />
							<input type="hidden" name="a" value="[% nextaction %]" />
							[% IF doc.intFileID && nature == 'NEW' %]
							<input type="hidden" name="f" value="[% doc.intFileID %]" />
							[% END %]
							[% FOREACH h IN hidden_ref %]
							
							<input type="hidden" name="[% h.key %]" value="[% h.value %]" />							
							[% END %]		
						</form>
						<script>
							var doc;
							Dropzone.options.myRegoDoc[% doc.ID %] = {
                                [% IF doc.intFileID %]
                                dictDefaultMessage: "<i class='fa fa-check file-uploaded'></i>[% Lang.txt('Uploaded') %] <br/> <i><span class='replace-text'>[% Lang.txt('To update this file drag and drop here') %]</span></i>",
                                [% ELSE %]
                                dictDefaultMessage: "[% Lang.txt('Drag and drop file here') %]",
                                [% END %]
								addRemoveLinks: true,							
								init: function(){
									this.on("success", function(file, response){										
										doc = response;		
									});								
									this.on("removedfile", function(file, response){
										var fObject = JSON.parse(doc);
										\$.ajax({
											type: 'POST',
											url: '[% url %]/deleteregofile.cgi',
											data: "f="+fObject.f + "&doctypeID="+fObject.docTypeID + "&rID="+fObject.regoID + "&client=[% client %]"
										}).done(
											
										);
									});
								}


							}
						</script>
					</td>
				</tr>
			[% END %]
		</table>
	</div>
</div>
<div class="clearfix">&nbsp;</div>
[% IF optionaldocs.size %]
<h3 class="panel-header">Optional Documents</h3> 
<div class="panel-body">
	<div class="document-notes">
		<table class="table documents-table">
			[% index = 0 %]
			[% FOREACH doc IN optionaldocs %]
			[% index = index + 1 %]
				<tr>
					<td>
						<div>
							<p><strong>Title:</strong> 
							[% doc.Name %]
							</p>
							
							[% IF doc.Description != '' %]
							
							<p><strong>Description: </strong>
								[% doc.Description %]
							</p>
						
							[% END %]

							[% IF doc.strOrigFilename != '' %]
							
							<p>
								<a href="#" onclick="docViewer([% doc.intFileID %], 'client=[% client %]&amp;a=view'); return false;">[% doc.strOrigFilename %]</a>
							</p>
						
							[% END %]
						</div>
					</td>
					<td style="width:50%;">
						<form action="uploadregofile.cgi" method="POST" class="dropzone" enctype="multipart/form-data" id="myRegoDoc[% doc.ID %]">
							<input type="hidden" name="client" value="[% client %]" />
							<input type="hidden" name="rID" value="[% regoID %]" />
							<input type="hidden" name="doctypeID" value="[% doc.ID %]" />
							<input type="hidden" name="a" value="[% nextaction %]" />
						
							[% FOREACH h IN hidden_ref %]
							
							<input type="hidden" name="[% h.key %]" value="[% h.value %]" />
							
							[% END %]
						</form>
						<script>
							var doc;
							Dropzone.options.myRegoDoc[% doc.ID %] = {
                                [% IF doc.intFileID %]
                                dictDefaultMessage: "<i class='fa fa-check file-uploaded'></i>[% Lang.txt('Uploaded') %] <br/> <i><span class='replace-text'>[% Lang.txt('To update this file drag and drop here') %]</span></i>",
                                [% ELSE %]
                                dictDefaultMessage: "[% Lang.txt('Drag and drop file here') %]",
                                [% END %]
								addRemoveLinks: true,							
								init: function(){
									this.on("success", function(file, response){										
										doc = response;		
									});								
									this.on("removedfile", function(file, response){
										var fObject = JSON.parse(doc);
										\$.ajax({
											type: 'POST',
											url: '[% url %]/deleteregofile.cgi',
											data: "f="+fObject.f + "&doctypeID="+fObject.docTypeID + "&rID="+fObject.regoID + "&client=[% client %]"
										}).done(
											
										);
									});
								}
							}
						</script>
					</td>
				</tr>
			[% END %]
		</table>
	</div>
</div>

[% END %]


[% IF !NoFormFields %]
<form action="[% target %]" method="POST">
<input type="hidden" name="a" value="[% nextaction %]">
[% FOREACH h IN  hidden_ref %]
<input type="hidden" name="[% h.key %]" value="[% h.value %]">
[% END %]
<input type="submit" name="submit" value="[% Lang.txt('Continue') %]" class = "button proceed-button"><br><br>
            </form>
[% END %]

</div>
