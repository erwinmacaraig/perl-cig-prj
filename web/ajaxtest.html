<html>
<head>

<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>

<script>
    function update_options(optionType, outputDiv)   {

        var qstring = '';
        qstring = '&sport=' + jquery('#selected_sport');
        qstring = '&ptype=' + jquery('#selected_ptype');
        jQuery('ajax/aj_rego_options.cgi?otype=' + optionType + qstring, function(data)    {
            if(data.results) {
              var items = [];
              jQuery.each( data, function( key, val ) {
                items.push( '<a href "#" data-val = "' + key + '" onclick = "updateselection(this, \'' + optionType + '\')">' + val + '</a>' );
              });
              jQuery('#selected_' + optionType).html(items.join(''));
            }
        });
    }
    function updateselection(element,optionType)   {
        var v = jQuery(element).attr('data-val');
        jQuery('#selected_' + optionType).val(jQuery(element).attr('data-val'));
        var nextlayer = {
            'sport' : {
                'key' : 'ptype',
                'val' : 'persontype',
            }
        };
        update_options(nextlayer[optionType]['key'],nextlayer[optionType]['val']);
        return false; 
    }
    update_options('sport', 'sportoptions');
</script>


</head>

<body>

<div id  = "sportoptions" class = "regoptions">
<a href = "#" data-val = "test" onclick = "updateselection(this,'sport')">Test</a>
</div>
<div id  = "persontype" class = "regoptions">
</div>
<input type = "hidden" id = "selected_sport">
<input type = "hidden" id = "selected_ptype">

<!--

Javascript returned something like
{ 
    "results" : {
        "football" : "Football"
        "Beach" : "Beach Football"


    }
}


-->



</body>
</html>

